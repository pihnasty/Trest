(function($){$.widget('depositphotos.depositViewItem',{options:{dpUrl:undefined,shortenLink:'http://dep.ph/v/',viewItemLink:undefined,fileBlocked:undefined,mode:'simple',responsive:{limitPopupWidth:770,limitPopupHeight:600},banners:{proffer:'ViewItemProffer'},preview:{showTitleSpeed:200},related:{relatedContentUrl:''},quick:{fullScreenWidth:1370,fullScreenHeight:680},inline:{slideHolderUp:200,slideHolderDown:200},searchParams:{sq:undefined,sqc:undefined,sqm:undefined,sst:undefined}},_init:function(){this.$this=this.element;this.itemId=this.$this.attr('data-id');this._addObserver();this.targets=this._gather();this.handlers=this._handlers();dp.core.binder(this.targets,this.handlers,this.widgetFullName||this.widgetBaseClass);dp.widgetCache.set('keyNavLocked',true);},_destroy:function(){dp.observer.remove(this.widgetName);dp.core.unbinder(this.targets,this.handlers,this.widgetFullName||this.widgetBaseClass);this.targets=this.handlers=undefined;dp.widgetCache.remove('keyNavLocked');},_gather:function(){var $holder=this.$this.find('.view-item-thumb');var $quick=this.$this.filter('.quick-view-item');var $inline=this.$this.filter('.inline-view-item');return{widget:{$frame:this.$this},preview:{$holder:$holder,$image:$holder.find('.image img[data-popup]'),$lens:$holder.find('.image .lens'),$close:$holder.find('.close'),$mejsContainer:$holder.find('.mejs-container'),$video:this.$this.find('#view-item-video'),$previewDepositItem:$holder.find('> .deposit-item'),$description:$holder.find('.description'),$thumbLink:$holder.find('.description a')},relative:{$items:this.$this.find('.view-item-block .deposit-item'),$links:this.$this.find('.view-item-block .deposit-item a.item-holder')},buttons:{$buttonsHolder:this.$this.find('.view-item-thumb .action'),$shareMenuHolder:this.$this.find('.share-menu'),$holderAligner:this.$this.find('.holder-aligner'),$currentToCart:this.$this.find('.view-item-thumb .action .cart'),$currentToLightbox:this.$this.find('.view-item-thumb .action .lightbox'),$shareMenuButton:this.$this.find('.share'),$downloadButton:this.$this.find('.download-button input'),$shareButton:this.$this.find('.share-menu a'),$navigation:this.$this.find('.d-top-right [data-direction], .quick-control [data-direction]'),$bannerClose:this.$this.find('.d-view-item-proffer-close')},indicators:{$lightbox:this.$this.find('.view-item-thumb .in-sections .in-lightbox-icon'),$cart:this.$this.find('.view-item-thumb .in-sections .in-cart-icon')},cart:{$wrap:$('.shopping-cart-menu')},variables:{$balance:$('span[data-balance]')},navigation:{$document:$(document),$window:$(window)},banners:{$info:this.$this.find('.view-item-help'),$proffer:this.$this.find('.d-view-item-proffer')},laconicSearch:{$form:$('.laconic-search-form'),$link:$('.userbar .laconic-search > a')},system:{$body:$('body'),$window:$(window)},contentMenu:{$menu:this.$this.find('.content-menu'),$menuItem:this.$this.find('.content-menu [data-content-menu] span')},quickViewItem:{$holder:$quick,$title:$quick.find('> h1'),$wrapper:$quick.find('.quick-wrapper'),$overlay:$('.quick-overlay'),$relatedContent:$quick.find('.related-content'),$closeButton:$quick.find('.close-popup'),$loading:$quick.find('.quick-loading i'),$nav:$quick.find('[data-direction]'),$fileUnavailable:$quick.find('.file-unavailable'),$toTopButton:$('.to-top-bicon')},inlineViewItem:{$wrapper:$inline.parent(),$holder:$inline,$contentWrapper:$inline.find('.inline-wrapper'),$relatedContent:$inline.find('.related-content'),$closeButton:$inline.parent().find('.close-inline'),$fileUnavailable:$inline.find('.file-unavailable'),$colorSwitcher:$inline.parent().find('.set-inline-color'),$openDepositItem:$('.open-inline'),$toTopButton:$('.to-top-bicon')},blockTitle:{$switch:this.$this.find('.show-full-title'),$wrapper:this.$this.find('.d-view-item-title'),$text:this.$this.find('.d-view-item-top h1')}};},_handlers:function(){var _this=this;return{widget:{frame:{run:function(){this.depositPriceTable({fileBlocked:_this.options.fileBlocked,mode:'viewitem',itemId:_this.getItemId()});_this.options.viewItemLink=this.attr('data-link')||'';_this.options.fileBlocked=!!parseInt(this.attr('data-blocked'));_this.options.dpUrl=dp.url();_this._initSearchParams();dp.observer.fire('itemViewed',[_this.$this.attr('data-id')]);if(dp.config.viewItemMode===0){dp.observer.fire('itemViewed',[_this.itemId]);}}}},preview:{lens:{handler:function(e){e.stopPropagation();switch(e.type){case'click':_this.targets.preview.$image.trigger('click');break;case'previewImageLoaded':this.style.display='block';break;}},events:['click','previewImageLoaded']},video:{run:function(){_this._initVideo();_this.targets.preview.$mejsContainer=_this.$this.find('.mejs-container');}},previewDepositItem:{run:function(){_this._initPreview(this.find('img[data-popup]'));$(this).draggable({appendTo:'body',containment:'body',zIndex:4001,scroll:false,opacity:0.5,cursor:'move',cursorAt:{left:0,top:0},delay:150,distance:5,connectToSortable:'.lb-panel-container',fromSortable:function(e,ui){ui.helper.appendTo('body');},helper:function(e,ui){var $helper=_this.targets.preview.$previewDepositItem.find('img:first').clone();$helper.attr('data-id',_this.targets.preview.$previewDepositItem.attr('data-id'));return $helper;},drag:function(e,ui){if(!$('.lb-panel-open').hasClass('hidden')&&ui.position.top>$(window).height()+$(document).scrollTop()-ui.helper.height()){dp.observer.fire('dragItemToLightboxPanel',['open']);$('.lb-panel-container').sortable('refresh');}}});if(_this.targets.preview.$previewDepositItem.attr('data-height')<110){_this.targets.preview.$holder.addClass('small-height');}}},image:{handler:function(){_this.targets.buttons.$buttonsHolder.trigger('previewImageLoaded');_this.targets.preview.$lens.trigger('previewImageLoaded');_this.targets.preview.$description.trigger('previewImageLoaded');},events:'load'},description:{handler:function(e){switch(e.type){case'previewImageLoaded':$(this).css('width',_this.targets.preview.$image.width()+'px');break;default:e.stopPropagation();}},events:['previewImageLoaded','mousedown']},thumbLink:{handler:function(e){e.preventDefault();},events:['click']}},relative:{links:{run:function(){if(_this.options.dpUrl.param('sq')){this.each(function(){var url=dp.url(this.href);url.param('sq',_this.options.dpUrl.param('sq'));url.param('sst',_this.options.dpUrl.param('sst'));this.href=url.attr('source');});}}},items:{run:'depositItem'}},buttons:{buttonsHolder:{handler:function(e){var popupName;var popup;var eventsForPlayer=['mouseover','mouseenter','mousemove','mouseout'];e.stopPropagation();this.style.height=_this.targets.preview.$previewDepositItem.attr('data-height');_this.targets.buttons.$holderAligner.css('height',_this.targets.preview.$previewDepositItem.attr('data-height')+'px');if(e.type==='click'){popupName=_this.targets.preview.$image.attr('data-popup');popup=dp.popup.show(popupName,this);_this.targets.preview.$video.trigger('click');}
if(eventsForPlayer.indexOf(e.type)!==-1){_this.targets.preview.$mejsContainer.trigger(e.type);}},events:['previewImageLoaded','click','mouseover','mouseenter','mousemove','mouseout'],run:function(){this.css('height',_this.targets.preview.$previewDepositItem.attr('data-height')+'px');}},shareMenuHolder:{handler:function(e){e.stopPropagation();_this._socialToggle();},events:['click']},currentToCart:{handler:function(e){var $this=$(this);e.stopPropagation();switch(e.type){case'click':case'touchstart':e.preventDefault();_this._addRemoveCartItem($this);break;case'indicate':_this._indicatePreviewButtons($this,arguments[1],_this.targets.indicators.$cart);break;}},events:['click','indicate','touchstart'],run:function(){var $this=$(this);dp.observer.add(_this.widget.widgetFullName+'cartIndicator','qViewItemCart',function(state){$this.trigger('indicate',state);var items={};items[_this.$this.attr('data-id')]=true;dp.observer.fire('cartAction',[state?'add':'remove',items]);});}},currentToLightbox:{handler:function(e){var $this=$(this);e.stopPropagation();switch(e.type){case'click':case'touchstart':e.preventDefault();_this._addRemoveLightboxItem($this);break;case'indicate':_this._indicatePreviewButtons($this,arguments[1],_this.targets.indicators.$lightbox);break;}},events:['click','indicate','touchstart']},shareMenuButton:{handler:function(e){e.stopPropagation();_this.targets.buttons.$shareMenuHolder.css('height',_this.targets.preview.$previewDepositItem.attr('data-height')+'px');_this._socialToggle();},events:['click']},shareButton:{handler:function(e){e.preventDefault();e.stopPropagation();_this._socialShare(this);_this._socialTracking(this);},events:'click',run:function(){_this._initSocials(this);}},navigation:{handler:function(){var offset=parseInt(this.getAttribute('data-direction'));if(offset!==0&&!isNaN(offset))_this._navigate(offset);}},bannerClose:{handler:function(){_this.targets.banners.$info.show();},events:'click'}},navigation:{document:{handler:function(e){if(!_this.targets||!(_this.targets.quickViewItem.$holder.is(':visible')||_this.targets.inlineViewItem.$holder.is(':visible')))return true;switch(e.type){case'keyup':_this._handleKeyUp(e);break;case'keydown':_this._handleKeyDown(e);break;}},events:['keyup','keydown']},window:{handler:function(e){switch(e.type){case'popstate':_this._popStateEvent(e);break;case'_resize':_this._resizeEvent(e);break;}},events:['popstate','_resize']}},banners:{info:{run:function(){if(_this.targets.banners.$proffer.is(':visible'))_this.targets.banners.$info.hide();}}},laconicSearch:{form:{run:function(){var $form=$(this);$form.removeClass('is-search-page');if($form.is(':visible')){_this.targets.laconicSearch.$link.trigger('click',false);}}}},system:{window:{handler:function(){_this._scrollEvent();},events:'scroll'}},contentMenu:{menu:{handler:function(){_this._initContentMenu();},events:'init'},menuItem:{handler:function(){_this._selectContentMenu($(this).parent());},events:'click'}},quickViewItem:{holder:{run:function(){_this._initQuickViewItem();},handler:function(e){switch(e.type){case'wait':_this.targets.quickViewItem.$holder.addClass('loading');_this.targets.quickViewItem.$loading.css('z-index',1);break;case'show':_this.targets.quickViewItem.$holder.removeClass('hidden');_this.targets.quickViewItem.$overlay.removeClass('hidden');break;case'hide':_this.targets.quickViewItem.$holder.addClass('hidden');_this.targets.quickViewItem.$overlay.addClass('hidden');break;case'close':_this._hideQuickViewItem();break;}},events:['wait','show','hide','close']},overlay:{handler:function(){_this._hideQuickViewItem();},events:'click'},closeButton:{handler:function(){_this._hideQuickViewItem();},events:'click'}},inlineViewItem:{holder:{run:function(){_this._initInlineViewItem();},handler:function(){_this._hideInlineViewItem();},events:'hide'},closeButton:{handler:function(){_this._hideInlineViewItem();},events:'click'},colorSwitcher:{handler:function(){_this._setInlineViewItemColor(this.getAttribute('data-value'));dp.track.fire('switch_inline_view_item_mode',[_this.options.itemId]);},events:'click'}},blockTitle:{switch:{handler:function(){var $text=_this.targets.blockTitle.$text;if($text.hasClass('opened-title')){$text.switchClass('opened-title','closed-title');}else{$text.switchClass('closed-title','opened-title');}},events:'click',run:function(){var $text=_this.targets.blockTitle.$text;var width=0;$text.find('span').each(function(indx,element){width+=(parseInt($(element).width()||0,10)||0);});if($text.width()-40<=width){_this.targets.blockTitle.$switch.show();}}}}};},getItemId:function(){return this.itemId;},_socialToggle:function(){this.targets.buttons.$shareMenuHolder.stop().fadeToggle(300);this.targets.preview.$holder.toggleClass('share-open');this.targets.preview.$lens.toggle();this.targets.preview.$close.toggle();},_indicatePreviewButtons:function($item,state,$thumbIndicator){if(state==true){$item.addClass('hidden').filter('[data-state="on"]').removeClass('hidden');$thumbIndicator.removeClass('hidden');}else{$item.addClass('hidden').filter('[data-state="off"]').removeClass('hidden');$thumbIndicator.addClass('hidden');}},_addObserver:function(){var _this=this;dp.observer.add(_this.widgetName,'addFavoritesFile',function(id){_this.targets.buttons.$currentToLightbox.filter('[data-id="'+id+'"]').trigger('indicate',true);});dp.observer.add(_this.widgetName,'deleteLightboxItem',function(id){_this.targets.buttons.$currentToLightbox.filter('[data-id="'+id+'"]').trigger('indicate',false);});dp.observer.add(_this.widgetName,'renewLamps, lbEmptyList',function(){var idsList=dp.lightbox?dp.lightbox.getFiles():[];_this.targets.buttons.$currentToLightbox.trigger('indicate',false);if(!idsList.length){return;}
if(idsList.indexOf(_this.targets.buttons.$currentToLightbox.attr('data-id'))!==-1){_this.targets.buttons.$currentToLightbox.trigger('indicate',true);}});dp.observer.add(_this.widgetName,'updateBalance',function(){_this.targets.variables.$balance.trigger('update');});dp.observer.add(_this.widgetName,'addToCart',function(callback){_this._addRemoveCartItem(_this.targets.buttons.$currentToCart.filter('.d_addToCart'),function(){dp.storage.set('trackBuyItem',true,true,0);if(typeof callback==='function'){callback();}
window.location.href=_this.targets.buttons.$downloadButton.data('href');});});dp.observer.add(_this.widgetName,'loadRelatedContent',function(){_this._loadRelatedContent();});dp.observer.add(_this.widgetName,'viewItemCartAction',function(action,id){if(_this.$this.attr('data-id')===id){_this.targets.buttons.$currentToCart.trigger('indicate',action==='add'?true:false);}
dp.loader.ajax.updateCache(_this.options.related.relatedContentUrl);});},_addRemoveCartItem:function($target,callback){var _this=this;var action;var url=dp.loader.ajax.getLastProcessedUrl();if($target.hasClass('d_addToCart')){_this.trackItemActionClick($target,'cart_add_icon_click');action='add';}else{action='remove';}
var onActionCallback=function(data,action){if(callback&&typeof callback==='function'){callback(data,action);}
_this.targets.buttons.$currentToCart.trigger('indicate',action==='add');dp.observer.fire('cartIndicator',[action,$target.attr('data-id')]);dp.loader.ajax.updateCache(url);};var $availCart=this.targets.cart.$wrap.filter(':visible');if($availCart.length===0)$availCart=this.targets.cart.$wrap.eq(0);$availCart.trigger(action+'Item',{data:{id:$target.attr('data-id')},callback:onActionCallback});},_initVideo:function(){if($.browser.mobile){return;}
this._player=new MediaElementPlayer('#view-item-video',{loop:true,success:function(player,node){$('#'+node.id+'-mode').html('mode: '+player.pluginType);if(player.player){player.player.disableControls();}
player.play();if(player.player){player.player.controlsEnabled=true;}}});},_addRemoveLightboxItem:function($target){var _this=this;var action=$target.hasClass('lightbox-add')?'add':'delete';var itemId=$target.attr('data-id');if($target.hasClass('lightbox-add')){_this.trackItemActionClick($target,'lightbox_add_icon_click');action='add';}else{action='delete';}
if(!dp.config.user.id){dp.popup.callback('need_auth','show',function(popup){dp.popup.dispatch($(popup).find('[data-popup]'));},true);return dp.popup.show('need_auth');}else{if(dp.lightbox&&action&&!$target.data('busy')){$target.data('busy',true);if(action==='add'){dp.lightbox.addFile(itemId,function(){$target.data('busy',false);},undefined,{sq:_this.options.dpUrl.param('sq')});}else{dp.lightbox.deleteFiles(itemId,null,function(){$target.data('busy',false);});}}}},_socialShare:function(target){var $target=$(target);var winTop=((screen.height/2)-($target.attr('data-height')/2)).toFixed(0);var winLeft=((screen.width/2)-($target.attr('data-width')/2)).toFixed(0);var winParams='top='+winTop+',left='+winLeft+',width='+$target.attr('data-width')+',height='+$target.attr('data-height')+',resizable=yes,scrollbars=no,status=yes,location=no';var win=window.open('about:blank',$target.attr('data-title'),winParams);win.location.href=$target.attr('href');},_socialTracking:function(target){var social=target.getAttribute('data-social');if(!social){return false;}
dp.track.perform('social',{network:social,action:'share'});},_initSocials:function(targets){var _this=this;var $targets=$(targets);var refId='';if(typeof dp.config.user.id!=='undefined'&&dp.config.user.id!==false&&dp.config.user.id!==0){refId='-'+dp.tools.base_convert(dp.config.user.id,10,36);}
var socialNameMap={facebook:1,twitter:2,google:3,pinterest:4};$targets.each(function(){var socialName=this.getAttribute('data-social');var url=encodeURIComponent(_this.options.shortenLink+dp.tools.base_convert(''+socialNameMap[socialName]+_this.$this.attr('data-id'),10,36)+refId);var href=this.getAttribute('data-href');var map={'%s':url,'%m':encodeURIComponent(_this.targets.preview.$holder.attr('data-thumb')),'%t':encodeURIComponent(document.title.replace(/#[0-9]+/gi,'#stock #photo')),'%d':encodeURIComponent(document.title)};for(var i in map){if(href.search(i)!==-1){href=href.replace(i,map[i]);}}
this.href=href;});},_initSearchParams:function(){var itemId=this.$this.attr('data-id');var $item=$('.deposit-item[data-id="'+itemId+'"]');if($item.length>0&&dp.config.search.quickPosition===false){dp.config.search.quickPosition=$item.attr('data-count');}
if(dp.config.search.quickPosition!==false&&dp.config.pager){this.options.searchParams.sqc=parseInt(dp.config.search.quickPosition);this.options.searchParams.sqm=parseInt(dp.config.pager.itemsCount);this.options.searchParams.sq=dp.config.search.id;this.options.searchParams.sst=parseInt(dp.config.pager.offset||0);}else{this.options.searchParams.sqc=parseInt(this.options.dpUrl.param('sqc'));this.options.searchParams.sqm=parseInt(this.options.dpUrl.param('sqm'));this.options.searchParams.sq=this.options.dpUrl.param('sq');this.options.searchParams.sst=parseInt(this.options.dpUrl.param('sst')||0);}},_makeNavigateUrl:function(offset){var currentOffset=this.options.searchParams.sqc;var minOffset=0;var maxOffset=this.options.searchParams.sqm;var searchId=this.options.searchParams.sq;var skip=this.options.searchParams.sst;var newOffset=currentOffset+offset;if(!searchId||newOffset<minOffset||newOffset>maxOffset-1){return false;}
var params={sst:skip,sqc:newOffset,sqm:maxOffset,sq:searchId};return'/search/?view_item=&st='+newOffset+'&'+searchId+'&'+$.param(params);},_navigate:function(offset){if(this.targets.inlineViewItem.$holder.length){this.targets.inlineViewItem.$holder.trigger('wait');dp.loader.ajax.options.stopWindowScroll=true;dp.observer.fire('searchClickItemNav',offset);return false;}
var location=this._makeNavigateUrl(offset);var viewUrl=false;if(!location){return;}
if(this.targets.quickViewItem.$holder.length){if(!this.targets.quickViewItem.$nav.length||dp.popup.instances['image-zoom']){return;}
this.targets.preview.$previewDepositItem.find('div.action').off('click');location+='&quick=1';this.targets.quickViewItem.$holder.trigger('wait');dp.loader.ajax.options.stopWindowScroll=true;viewUrl=dp.widgetCache.get('quickViewItemBackUrl');}
dp.track.fire('other_quick_view_item',[offset===1?'Right':'Left',this.$this.attr('data-id')]);if(dp.config.search.quickPosition!==false){dp.config.search.quickPosition=dp.tools.number(dp.config.search.quickPosition)+offset;}
dp.loader.ajax.load(location,function($el){if(viewUrl&&history&&history.replaceState){var url=dp.url(viewUrl);url.param('qview',dp.url().attr('directory').replace(/n?\//g,''));history.replaceState({from:'ajaxLoader'},document.title,url.attr('source'));var $link=$el.find('[data-role="quick-title"] a');if($link.length){dp.track.extraPage(dp.url().data.attr.base+$link.attr('href'));}}
dp.observer.fire('loadRelatedContent');},false,true);},_handleKeyUp:function(e){if(e.keyCode===27){if(this.targets.quickViewItem.$holder.length&&this.targets.quickViewItem.$holder.is(':visible')){this._hideQuickViewItem();}}
if((e.keyCode!==37&&e.keyCode!==39)||(e.target.tagName.toLowerCase()==='input'||e.target.tagName.toLowerCase()==='select')){return;}
this._navigate(e.keyCode===37?-1:1);},_handleKeyDown:function(e){if(e.keyCode===27){if(this.targets.inlineViewItem.$holder.length&&this.targets.inlineViewItem.$holder.is(':visible')&&typeof dp.popup.instances['image-zoom']==='undefined'){this._hideInlineViewItem();}}},_initQuickViewItem:function(){this.targets.quickViewItem.$toTopButton.addClass('show-quick');if(dp.config.pager){dp.config.pager.cacheEnabled=false;}
this._quickPosition('init');this._loadRelatedContent(this.targets.quickViewItem);this._setCacheForNextItem();dp.track.fire('show_quick_view_item',[this.options.itemId]);this.targets.quickViewItem.$holder.attr('tabindex',-1).focus();},_initInlineViewItem:function(){this.targets.inlineViewItem.$toTopButton.addClass('show-quick');switch(parseInt(dp.config.viewItemMode)){case 2:dp.track.fire('show_inline_2_view_item',[this.options.itemId]);break;case 3:dp.track.fire('show_inline_3_view_item',[this.options.itemId]);break;}
this.targets.inlineViewItem.$holder.attr('tabindex',-1).focus();},_quickPosition:function(type){if(this.targets.system.$window.width()<this.options.quick.fullScreenWidth||this.targets.system.$window.height()<this.options.quick.fullScreenHeight){if(!this.targets.quickViewItem.$holder.hasClass('full-screen')){this._initQuickScroll();this.targets.quickViewItem.$holder.css('top',0).addClass('full-screen');this.targets.system.$window.scrollTop(0);}else{this.targets.system.$body.css('height',Math.max(this._getQuickViewItemHeight(),this.targets.system.$window.height()));}}else{if(this.targets.quickViewItem.$holder.hasClass('full-screen')){this.targets.quickViewItem.$holder.removeClass('full-screen');this._destroyQuickScroll();}
var top=Math.floor((this.targets.system.$window.height()/2)-(this.targets.quickViewItem.$holder.outerHeight()/2));this.targets.quickViewItem.$holder.css('top',Math.max(top,0)+'px');if(type==='init'){this.targets.quickViewItem.$relatedContent.removeClass('hidden');}}},_initQuickScroll:function(){var scrollTop=this.targets.system.$window.scrollTop();if(!dp.widgetCache.get('quickTopFullScreen')){dp.widgetCache.set('quickTopFullScreen',scrollTop);}else{scrollTop=dp.widgetCache.get('quickTopFullScreen');}
this.targets.system.$body.css({'height':Math.max(this._getQuickViewItemHeight(),this.targets.system.$window.height()),'overflow':'hidden'});},_destroyQuickScroll:function(){var top=Math.abs(parseInt(dp.widgetCache.get('quickTopFullScreen')));this.targets.system.$body.css({'height':'','overflow':''});dp.widgetCache.remove('quickTopFullScreen');if(top>0){this.targets.system.$window.scrollTop(top);}},_getQuickViewItemHeight:function(){var height=this.targets.quickViewItem.$wrapper.outerHeight();height+=this.targets.quickViewItem.$title.outerHeight();height+=parseInt(this.targets.quickViewItem.$holder.css('paddingTop'));height+=parseInt(this.targets.quickViewItem.$holder.css('paddingBottom'));return height;},_hideQuickViewItem:function(){if(dp.config.pager){dp.config.pager.cacheEnabled=true;}
dp.widgetCache.remove('keyNavLocked');dp.config.search.quickPosition=undefined;this._destroyQuickScroll();dp.tips.hideAll();this.targets.quickViewItem.$overlay.detach();this.targets.quickViewItem.$holder.detach();this.targets.quickViewItem.$toTopButton.removeClass('show-quick');if(!history||!history.pushState){window.location.href=dp.widgetCache.get('quickViewItemBackUrl');return;}
if(dp.widgetCache.get('quickViewItemBackUrl')&&dp.widgetCache.get('quickViewItemBackUrl')!==window.location.href){history.pushState({from:'ajaxLoader',scroll:$(window).scrollTop()},document.title,dp.widgetCache.get('quickViewItemBackUrl'));dp.observer.fire('pushstate',dp.widgetCache.get('quickViewItemBackUrl'));dp.widgetCache.remove('quickViewItemBackUrl');}
this._destroy();},trackItemActionClick:function($button,eventCode){if(!$button.data('wasTrackingClicked')){$button.data('wasTrackingClicked',true);dp.track.fire(eventCode,[dp.config.user.id?'User logged':'User not logged']);}},_hideInlineViewItem:function(){var _this=this;dp.widgetCache.remove('keyNavLocked');this.targets.inlineViewItem.$toTopButton.removeClass('show-quick');dp.tips.hideAll();this.targets.inlineViewItem.$wrapper.slideUp(this.options.inline.slideHolderUp,function(){if(_this.targets&&_this.targets.inlineViewItem){_this.targets.inlineViewItem.$wrapper.addClass('hidden');}});var previewsStatus=$('.search-result .deposit-item').filter(':not(.open-inline)').first().attr('data-tips-disabled')||false;this.targets.inlineViewItem.$openDepositItem.attr('data-tips-disabled',previewsStatus).removeClass('open-inline');if(!history||!history.pushState){window.location.href=dp.widgetCache.get('inlineViewItemBackUrl');return;}
if(dp.widgetCache.get('inlineViewItemBackUrl')&&dp.widgetCache.get('inlineViewItemBackUrl')!==window.location.href){history.pushState({from:'ajaxLoader',scroll:$(window).scrollTop()},document.title,dp.widgetCache.get('inlineViewItemBackUrl'));dp.observer.fire('pushstate',dp.widgetCache.get('inlineViewItemBackUrl'));dp.widgetCache.remove('inlineViewItemBackUrl');return;}
this._destroy();},_loadRelatedContent:function(){var _this=this;if(this.options.fileBlocked===true){return false;}
if(dp.widgetCache.get('blockRelated')){dp.widgetCache.remove('blockRelated');return false;}
if(typeof this.targets.quickViewItem==='undefined'||typeof this.targets.inlineViewItem==='undefined'||!_this.options.related.relatedContentUrl){return false;}
dp.loader.ajax.options.stopWindowScroll=true;dp.loader.ajax.load(_this.options.related.relatedContentUrl,function($roles){$roles.filter('[data-role="related-content"]').find('.view-item-block .deposit-item').depositItem();_this._initContentMenu();dp.observer.fire('renewLamps');dp.loader.ajax.__counter--;},true,true);if(this.targets.quickViewItem.$holder.length>0&&this.targets.quickViewItem.$holder.is(':visible')){this._quickPosition('resize');}},_initContentMenu:function(){if(this.targets&&this.targets.contentMenu){var activeDataContentBlock=$('.active[data-content-block]').attr('data-content-block');this.targets.contentMenu.$menuItem.each(function(){var $item=$(this).parent();var $dataContentMenu=$('[data-content-menu="'+$item.attr('data-content-menu')+'"]');if($('[data-content-block="'+$item.attr('data-content-menu')+'"]').length){$dataContentMenu.removeClass('hidden');}else{$dataContentMenu.addClass('hidden');}});if(activeDataContentBlock){$('[data-content-menu]').removeClass('active').filter('[data-content-menu="'+activeDataContentBlock+'"]').addClass('active');}else{this.targets.contentMenu.$menuItem.filter(':visible:first').trigger('click');}}},_selectContentMenu:function($item){var $contentBlocks=$('[data-content-block]');$contentBlocks.removeClass('active');$contentBlocks.filter('[data-content-block="'+$item.attr('data-content-menu')+'"]').addClass('active');this.targets.contentMenu.$menuItem.parent().removeClass('active');$item.addClass('active');},_setCacheForNextItem:function(){var offset=this.options.searchParams.sqc;var maxOffset=this.options.searchParams.sqm;if(offset<=0){this.targets.quickViewItem.$nav.eq(0).hide();}
if(offset>=maxOffset){this.targets.quickViewItem.$nav.eq(1).hide();}
if(dp.loader.ajax.__counter+1===dp.loader.ajax.options.lifetime){this.targets.quickViewItem.$nav.hide();}
var navigateUrl=this._makeNavigateUrl(offset>dp.widgetCache.get('quickViewItemLastOffest')?+1:-1);if(!navigateUrl){return false;}
dp.loader.ajax.makeCache(navigateUrl+'&quick=1');dp.widgetCache.set('quickViewItemLastOffest',offset);},_setInlineViewItemColor:function(index){var _this=this;if(dp.config.user.id){dp.observer.add('depositViewItem','storageReady',function(){var $item=_this.targets.inlineViewItem.$openDepositItem;var url=dp.url($item.find('.item-holder').attr('href'));url.param('inlinecolor',index);dp.observer.fire('showInlineViewItem',[url.attr('source'),$item]);});}
dp.storage.set('qViewItem',index);if(!dp.config.user.id){window.location.reload();}},_popStateEvent:function(){if(this.targets.quickViewItem.$holder.length>0&&this.targets.quickViewItem.$holder.is(':visible')&&window.location.href.search('qview')===-1){this._hideQuickViewItem();return;}
if(this.targets.inlineViewItem.$holder.length>0&&this.targets.inlineViewItem.$holder.is(':visible')&&window.location.href.search('qview')===-1){this._hideInlineViewItem();return;}},_resizeEvent:function(){if(this.targets.quickViewItem.$holder.length>0&&this.targets.quickViewItem.$holder.is(':visible')){this._quickPosition('resize');}
if(window.innerHeight<this.options.responsive.limitPopupHeight||window.innerWidth<this.options.responsive.limitPopupWidth){dp.popup.hide('image-zoom');}else{this._resizeImagePreview();}},_scrollEvent:function(){if(this.targets.quickViewItem.$holder.length>0&&this.targets.quickViewItem.$holder.is(':visible')){dp.tips.hideAll();}},_initPreview:function($source){var _this=this;var $popup=dp.popup.get('image-zoom');if(!$popup){return false;}
var $newImage=$('<img data-popup-close />');var $viewItemImage=$('.view-item-thumb img:first');var $image=$popup.find('img');var $text=$popup.find('.d-popup-image-title');var title=$source.attr('data-title');var src=$source.attr('data-src');var height=this._getPreviewHeight($source.attr('data-height'));var $downloadButton=$text.find('a');var $bgSelectors=$popup.find('.bg-selector-outer');var $bgSelectorsHandler=$bgSelectors.find('.handler');var bgSelectorsEnabled=!(this.targets.quickViewItem.$holder.length||this.targets.inlineViewItem.$holder.length);var imageWidth=Math.floor(height*$viewItemImage.width()/$viewItemImage.height());$text.addClass('hide-title');var imgSmall=new Image();imgSmall.onload=function(){$newImage.insertAfter($image);$newImage.off().on('click.depositPopup',function(){dp.popup.hide('image-zoom');});$image.remove();$popup.trigger('position');};imgSmall.src=src;$newImage.attr({src:$viewItemImage.attr('src'),width:imageWidth,height:height});var imgBig=new Image();imgBig.onload=function(){$text.width(Math.floor(height*imgBig.width/imgBig.height)).removeClass('hide-title');$text.find('span:first').text(title);$newImage.removeAttr('width');$popup.trigger('position');};imgBig.src=src;this.$this.on('remove',function(){imgBig.onload=null;imgSmall.onload=null;});$newImage.attr({src:src,alt:title,title:title});if($downloadButton.length){$downloadButton.off('click.depositViewItem').on('click.depositViewItem',function(){dp.track.fire('click_download_button_preview',[_this.$this.attr('data-id')]);dp.popup.hide('image-zoom');_this.targets.buttons.$downloadButton.trigger('click');});}
dp.popup.removeCallbacks('image-zoom','condition-show');dp.popup.callback('image-zoom','condition-show',function(){return _this.options.responsive.limitPopupWidth<window.innerWidth&&_this.options.responsive.limitPopupHeight<window.innerHeight;},true);dp.popup.removeCallbacks('image-zoom','show');dp.popup.callback('image-zoom','show',function($popup){dp.track.fire('show_download_button_preview',[_this.$this.attr('data-id')]);dp.tips.hideAll();var $closeCross=$popup.find('.popup-close.outside-position');var $quickViewItem=$('.quick-view-item');var $popupOverlay=$('.popup-overlay[data-name="image-zoom"]');var opacityValue=0.8;if($quickViewItem.length>0){$quickViewItem.trigger('hide');bgSelectorsEnabled=false;opacityValue=1;$popupOverlay.addClass('non-transparent');}
if(bgSelectorsEnabled){var opacityIndex=dp.storage.get('depositBackground');if(typeof opacityIndex!=='object'){var $activeBg=$bgSelectorsHandler.removeClass('active').filter('[data-index="'+opacityIndex+'"]');$activeBg.addClass('active');opacityValue=1-dp.tools.number($activeBg.attr('data-brightness')/100);}}
$popupOverlay.css('opacity',opacityValue);if(_this.options.mode==='popup'){$popupOverlay.off('click.depositViewItem').on('click.depositViewItem',function(){$quickViewItem.trigger('close');});$closeCross.off('click.depositViewItem').on('click.depositViewItem',function(){$quickViewItem.trigger('close');});}},true);dp.popup.callback('image-zoom','hide',function($popup){var $quickViewItem=$('.quick-view-item');var $popupOverlay=$('.popup-overlay[data-name="image-zoom"]');$popupOverlay.hide();if($quickViewItem.length>0){$quickViewItem.trigger('show');}},true);if(bgSelectorsEnabled){$bgSelectors.removeClass('hidden');$bgSelectorsHandler.off().on('click.depositViewItem',function(){$bgSelectorsHandler.removeClass('active');$(this).addClass('active');$('.popup-overlay[data-name="image-zoom"]').css('opacity',1-dp.tools.number($(this).find('i').css('opacity')));dp.storage.set('depositBackground',$(this).attr('data-index'));});}},_resizeImagePreview:function(){var $popup=dp.popup.get('image-zoom');if($popup&&$popup.is(':visible')){var $popupImage=$popup.find('img');var height=this._getPreviewHeight(this.targets.preview.$previewDepositItem.find('img[data-popup]').attr('data-height'));$popupImage.attr('height',height);$popup.find('.d-popup-image-title').css('width',$popupImage.width());$popup.trigger('position');}},_getPreviewHeight:function(height){return Math.min(dp.tools.number(height),Math.floor($(window).height()*0.75));}});})(jQuery);
;(function($){$.widget('depositphotos.depositPriceTable',{options:{fileBlocked:false,mode:'cart'},_init:function(){this.$this=this.element;this._addObserver();this.targets=this._gather();this.handlers=this._handlers();dp.core.binder(this.targets,this.handlers,this.widgetFullName||this.widgetBaseClass);},_destroy:function(){dp.observer.remove(this.widgetName+'_'+this._uuid);clearTimeout(this._iframeLoaderId);dp.core.unbinder(this.targets,this.handlers,this.widgetFullName||this.widgetBaseClass);this.targets=this.handlers=undefined;},_gather:function(){return{widget:{$element:this.$this},controls:{$sizeItemRowSelector:this.$this.find('.table-tr'),$methodsSwitcher:this.$this.find('input[name="method"]'),$columnSwitcher:this.$this.find('.column-switch > span'),$downloadButtons:this.$this.find('button[type="submit"], input[type="submit"]'),$buyMethodsMenuTips:this.$this.find('.buy-methods-menu[data-tips-id]')},elements:{$disabledButtonNote:this.$this.find('.d-el-note'),$methodsContainers:this.$this.find('[data-method-name]'),$switcherContainers:this.$this.find('[data-switch-name]'),$sizeSwitcher:this.$this.find('input[name="size"]'),$sizeRadio:this.$this.find('.radio-bicon'),$resultsIcons:this.$this.find('.re-download .item-purchased, .re-download span'),$form:this.$this.find('form'),$idInput:this.$this.find('input[name="id"]'),$sizeInput:this.$this.find('input[name="size"][type="hidden"]'),$licenseInput:this.$this.find('input[name="license"]'),$purchasedInput:this.$this.find('input[name="purchased"]'),$balanceSubscribeLinks:this.$this.find('span[data-method]'),$balanceValues:this.$this.find('span[data-balance]'),$inlineFileType:this.$this.find('.inline-file-type [data-size]'),$blockSubscribeLinks:this.$this.find('a[data-method]')},cartInHeader:{countItemsInCart:$('.shopping-cart-counter')}};},_handlers:function(){var _this=this;return{widget:{element:{handler:function(e){switch(e.type){case'setMethod':var method=_this.targets.controls.$buyMethodsMenuTips.find('.active[data-method]:first').attr('data-method');_this._selectBuyMethod(method);break;}},events:'setMethod',run:function(){if(_this.options.fileBlocked){_this.targets.controls.$downloadButtons.addClass('d-disabled');}}}},controls:{methodsSwitcher:{handler:function(){_this._selectBuyMethod(this.value);},events:'click',run:function(){_this._selectBuyMethod(_this._getActiveBuyMethod());}},sizeItemRowSelector:{handler:function(e){var sizeInputElement=$(this).find('input[name="size"]').get(0);e.stopPropagation();dp.tips.hideAll();if(typeof sizeInputElement!=='undefined'&&typeof sizeInputElement.value!=='undefined'){_this._selectSize(sizeInputElement.value,sizeInputElement.getAttribute('data-license'),!!sizeInputElement.getAttribute('data-purchased'));}},events:'click',run:function(){_this._selectSize(_this._getActiveSize(),_this._getActiveLicense(),_this._getActivePurchased());}},columnSwitcher:{handler:function(){_this._columnSwitcher(this.getAttribute('data-switch'),this.getAttribute('data-switch-param'));},events:'click'},downloadButtons:{handler:function(e){var $button=$(this);if($button.hasClass('d-disabled')||$button.hasClass('hidden')||_this.options.fileBlocked){e.preventDefault();e.stopPropagation();return false;}
if(this.getAttribute('data-size')!==null){_this._selectSize(this.getAttribute('data-size'),this.getAttribute('data-license'),this.getAttribute('data-purchased'));_this.targets.elements.$sizeInput.val(this.getAttribute('data-size'));_this.targets.elements.$licenseInput.val(this.getAttribute('data-license'));_this.targets.elements.$purchasedInput.val(!!this.getAttribute('data-purchased'));}
$button.trigger('loading');},events:'click',run:function(){$(this).depositLoading();if(_this.targets.controls.$downloadButtons.length===1){var dataSmartText=_this.targets.controls.$downloadButtons.attr('data-smart-event').match(/click_download_button,.*[^;]/)[0].split(',')[1];dp.track.fire('show_download_button',[dataSmartText]);}else{_this.options.mode='cart';}}},buyMethodsMenuTips:{run:function(){_this._initPlansMenuTips();}}},elements:{form:{handler:function(e){e.preventDefault();var data=_this._getData();var url=dp.loader.ajax.getLastProcessedUrl();if(!data.purchased&&data.method==='subscription'&&dp.config.user.subscriptionFilesCount===0&&!!dp.config.user.subscriptionRechargeInfo){dp.popup.show('subscription_limit_warning');return false;}
if(!dp.config.user.id&&_this.options.mode!=='cart'){dp.observer.fire('addToCart',[function(){_this.targets.controls.$downloadButtons.not('.hidden').trigger('loaded');}]);return false;}
if(dp.config.user.id){var paymentType=dp.tools.capitalize(data.method);var userType=dp.config.user.type?dp.tools.capitalize(dp.config.user.type):'Guest';dp.track.fire(_this.options.mode==='cart'?'click_download_button_users_cart':'click_download_button_users',[userType+paymentType,dp.config.user.id,_this.options.itemId]);}
dp.core.ajax({url:this.getAttribute('action'),data:data,success:function(response){var responseData;if(response&&response.data){responseData=response.data;if(response.result===true&&!response.errors){dp.loader.ajax.updateCache(url);dp.observer.fire('updateBalance',[responseData.balance]);_this._initIframe(responseData.link,function(){_this._buyResponseIndicate(data,response);});}else{if(response.errors&&response.errors.link){setTimeout(function(){window.location.href=response.errors.link;},800);}
return _this._buyResponseIndicate(data,response);}}else{$.error('jquery.depositPriceTable.js. Cannot get download link. Something wrong with arrived data.');}},error:function(){$.error('jquery.depositPriceTable.js. Cannot get download link. Ajax error.');}});dp.track.extraPage('/ingoing/download/'+data.method+'/'+dp.config.lang+'/'+data.id);},events:'submit'}}}},_addObserver:function(){this._uuid=getUUID();var key=this.widgetName+'_'+this._uuid;dp.observer.add(key,'checkDownloadButtons',(function(method){this._checkDownloadButtons();}).bind(this));dp.observer.add(key,'updateBalance',(function(balance){dp.config.user.credits=balance.credits?dp.tools.number(balance.credits):0;dp.config.user.subscriptionFilesCount=balance.subscriptionCount?balance.subscriptionCount:0;dp.config.user.imagePacksCount=balance.imagepacksCount?dp.tools.number(balance.imagepacksCount):0;dp.config.user.activeSubscription=balance.activeSubscriptions;dp.config.user.subscriptionRechargeInfo=balance.subscriptionRechargeInfo;dp.config.user.cartItemsCount=balance.cartItemsCount;this._updateBalance();this._updateCountItemsInCart();}).bind(this));},_selectBuyMethod:function(method){var $selectMethod=this.targets.controls.$methodsSwitcher.filter('[value="'+method+'"]');if($selectMethod.length>0&&typeof $selectMethod.attr('disabled')==='undefined'){this.targets.controls.$methodsSwitcher.parent().removeClass('active');$selectMethod.parent().addClass('active');$selectMethod.prop('checked',true);var elements=this.targets.elements.$methodsContainers.not('[data-type-column="download"]');elements.addClass('hidden').removeClass('discount');elements.filter('[data-method-name="'+method+'"]').removeClass('hidden').addClass('discount');this._checkDownloadButtons();}},_checkDownloadButtons:function(){var _this=this;var formData=this._getData();var method=formData.method;if(!dp.config.user.id){method='credits';}
this.targets.controls.$downloadButtons.each(function(){var $button=$(this);var license=this.getAttribute('data-license')||formData.license;if(method!=='credits'&&license==='extended'||_this.options.fileBlocked){if(this.getAttribute('data-size')===null){$button.addClass('d-disabled');}else{$button.addClass('hidden');}
_this.targets.elements.$disabledButtonNote.show();$button.not('[data-single-button="download"]').parent().hide();}else{if(dp.config.user.credits||dp.config.user.subscriptionFilesCount.length||dp.config.user.imagePacksCount||dp.config.user.activeSubscription){_this.targets.elements.$disabledButtonNote.hide();$button.parent().show();}
$button.removeClass('hidden');$button.removeClass('d-disabled');}});},_getData:function(){return this.targets.elements.$form.serializeForm();},_updateBalance:function(){var _this=this;_this.targets.elements.$blockSubscribeLinks.each(function(index,item){var el=$(item);var method=el.attr('data-method');if(dp.config.user.activeSubscription){if(method==='subscription'){var subscriptionId=dp.tools.number(el.attr('data-subscription-id'));var balanceItem=dp.config.user.subscriptionFilesCount[subscriptionId];el.find('span[data-balance]').html(balanceItem);}else{var balanceItem=(method==='credits')?dp.tools.number(dp.config.user.credits):dp.tools.number(dp.config.user.imagePacksCount);el.find('[data-balance="'+method+'"]').html((method==='credits')?balanceItem.dpNumberFormat(2,'.',''):balanceItem);}}});},_updateCountItemsInCart:function(){var cartItemsCount=dp.tools.number(dp.config.user.cartItemsCount);this.targets.cartInHeader.countItemsInCart.attr('data-value',cartItemsCount).text(cartItemsCount);},_getActiveBuyMethod:function(){return this.targets.controls.$methodsSwitcher.filter(':checked').val()||'credits';},_selectSize:function(size,license,purchased){var $selectItemRow=this.targets.controls.$sizeItemRowSelector.filter('[data-size="'+size+'"]');if($selectItemRow.length){this.targets.controls.$sizeItemRowSelector.removeClass('active');$selectItemRow.addClass('active');this.targets.elements.$sizeSwitcher.filter('[value="'+size+'"]').prop('checked',true);this.targets.elements.$sizeRadio.removeClass('active').filter('[data-value="'+size+'"]').addClass('active');if(typeof this.targets.elements.$inlineFileType!=='undefined'){this.targets.elements.$inlineFileType.removeClass('active').filter('[data-size="'+size+'"]').addClass('active');}
this.targets.elements.$licenseInput.val(license);this.targets.elements.$purchasedInput.val(!!purchased);this._checkDownloadButtons();}},_getActiveSize:function(){return this.targets.elements.$sizeSwitcher.filter(':checked').val();},_getActiveLicense:function(){return this.targets.elements.$sizeSwitcher.filter(':checked').attr('data-license');},_getActivePurchased:function(){return this.targets.elements.$sizeSwitcher.filter(':checked').attr('data-purchased');},_columnSwitcher:function(name,param){this.targets.controls.$columnSwitcher.filter('[data-switch="'+name+'"]').removeClass('active').filter('[data-switch-param="'+param+'"]').addClass('active');this.targets.elements.$switcherContainers.filter('[data-switch-name="'+name+'"]').removeAttr('style').addClass('hidden').filter('[data-switch-param="'+param+'"]').removeClass('hidden');},_initIframe:function(link,callback){var _this=this;var uuid=getUUID();var $iframe;if(($.browser&&$.browser.msie&&parseInt($.browser.version)<=7)||($.browser&&$.browser.mobile)){callback();return window.location.href=link;}
$iframe=$('<iframe/>',{'class':'d-invisible','data-uuid':uuid});_this.$this.append($iframe);$iframe.attr('src',link+(link.indexOf('?')!==-1?'&':'?')+'uuid='+uuid);if(typeof(this._iframeLoaderData)!=='object'){this._iframeLoaderData={};}
this._iframeLoaderData[uuid]={$iframe:$iframe,callback:callback,toDelete:false,errors:false};$iframe.on('load.priceTable',function(e){var uuid=this.getAttribute('data-uuid');_this._iframeLoaderData[uuid].toDelete=true;_this._iframeLoaderData[uuid].errors=true;});this._iframeDaemon();},_iframeDaemon:function(){var _this=this;var iframeDaemonHandler=function(){clearTimeout(_this._iframeLoaderId);if($.isEmptyObject(_this._iframeLoaderData)){return false;}
for(var i in _this._iframeLoaderData){if(_this._iframeLoaderData[i].toDelete){if(_this._iframeLoaderData[i].callback&&typeof _this._iframeLoaderData[i].callback==='function'){_this._iframeLoaderData[i].callback(!_this._iframeLoaderData[i].errors);}
_this._iframeLoaderData[i].$iframe.remove();delete _this._iframeLoaderData[i];$.removeCookie(i,{path:'/',domain:dp.config.domain.current||'.depositphotos.com'});}else{if($.cookie(i)===i){_this._iframeLoaderData[i].$iframe.remove;_this._iframeLoaderData[i].toDelete=true;}}}
_this._iframeLoaderId=setTimeout(iframeDaemonHandler,1000);};iframeDaemonHandler();},_buyResponseIndicate:function(data,response){var $result;var $results=this.targets.elements.$resultsIcons.filter('[data-size="'+data.size+'"]').addClass('hidden');$result=$results.filter('[data-result="'+response.result.toString()+'"]').removeClass('hidden');this.targets.controls.$sizeItemRowSelector.filter('[data-size="'+data.size+'"]').find('[data-method-name]').remove();if(response.result===true&&$result.length>0){$result=$result.filter('a');var href=$result.attr('href');href=href.replace(/\-[0-9]+/,'-');$result.attr('href',href+data.id);dp.observer.fire('itemDownloaded',data.id);}else{if(response.errors&&response.errors.message){$result.attr('title',tr(response.errors.message));}}
this.targets.controls.$downloadButtons.not('.hidden').trigger('loaded',response.result);},_initPlansMenuTips:function(){var _this=this;if(!this.targets.controls.$buyMethodsMenuTips.length)return false;this.targets.controls.$buyMethodsMenuTips.depositTips({type:'html',display:{effect:'none',show:'click',hide:'click',keyCode:13,hideTimeout:0,showTimeout:0,hideOnParent:false},pointer:{show:true,position:'auto',priority:['tm','rm','lm','bl','br','tl','tr','rt','rb','lt','lb','auto']},template:{linking:'parent',position:'auto',priority:['br','bm','bl','tm','rm','lm','tl','tr','rt','rb','lt','lb','auto']},callbacks:{show:function($tips){dp.helpers.updateBalanceHandler($tips);$tips.find('.plan-item[data-method]').off('click.depositPriceTable').on('click.click.depositPriceTable',function(){_this._setSubscriptionNumber($(this));_this._switchMethodWithTips($(this).attr('data-method'));dp.tips.instances[$(this).parent().attr('data-tips-for')].trigger('hide');});}}});},_switchMethodWithTips:function(method){this._selectBuyMethod(method);this.targets.controls.$buyMethodsMenuTips.find('[data-method]').removeClass('active').filter('[data-method="'+method+'"]').addClass('active');},_setSubscriptionNumber:function($selectedPlan){var subscriptionId=dp.tools.number($selectedPlan.attr('data-subscription-id'));var serialNumber=dp.tools.number($selectedPlan.attr('data-serial-number-subscription'));this.targets.elements.$form.find('input[name="subscription"]').val((!isNaN(subscriptionId))?subscriptionId:0);this.targets.elements.$form.find('.serial-number-subscription').html(serialNumber);}});})(jQuery);
;